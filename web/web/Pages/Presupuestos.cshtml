@page
@model web.Pages.PresupuestosModel
@{
    ViewData["Title"] = "Presupuestos";
    Layout = "~/Pages/_Layout.cshtml";
}

@section Scripts {
    <script src="~/dist/presupuestosApp.bundle.js" type="text/javascript"></script>
}

@Html.Partial("_KoGlobalTemplates")

<h2>Presupuestos</h2>

<div id="presupuestosForm">
    <!-- ko  template: { name: "DatosEmpresa" } --><!-- /ko -->
    <div id="accordion" class="my-lg-5">
        <!-- ko foreach: presupuestos.value -->
        <div class="card">
            <form data-bind="submit: guardar" novalidate>
                <div class="card-header">
                    <h5 class="mb-0">
                        <button type="button" class="btn btn-link" data-toggle="collapse" aria-expanded="true">
                            <span>Title?</span>
                        </button>
                    </h5>
                </div>
                <div class="collapse show" data-parent="#accordion">
                    <div class="card-body">
                        <!-- ko  template: { name: "Presupuesto" } --><!-- /ko -->
                    </div>
                </div>
            </form>
        </div>
        <!-- /ko -->
    </div>
</div>

<script id="DatosEmpresa" type="text/html">
    <div class="form">
        <div class="form-group mx-1 text-right">
            <button class="btn btn-default">Agregar</button>
            <button class="btn btn-default">Ver</button>
            <button type="button" class="btn btn-default">Volver</button>
        </div>
    </div>
</script>

<script id="Presupuesto" type="text/html">
    <form class="form" novalidate>
        <h3>
            Cotización
        </h3>

        <!-- ko template: { name: "Cotizacion" } -->
        <!-- /ko  -->

        <div class="row">
            <div class="col-md-12">
                <br />
                <br />
            </div>
        </div>

        <!-- ko template: { name: "Materiales" } -->
        <!-- /ko  -->

    </form>
</script>

<script id="Cotizacion" type="text/html">
    <div class="row">
        <div class="col-md-8">
            <div class="form-row">
                <div class="col-md-2">
                    <label>Cantidad</label>
                    <input type="text" class="form-control" placeholder="Cantidad" data-bind="value: cantidad.value, hasFocus: true, css: { 'is-invalid': cantidad.hasError() }" />
                    <!-- ko template: { name: "Validation", data: cantidad } -->
                    <!-- /ko  -->
                </div>

                <div class="col-md-10">
                    <label>Descripción</label>
                    <input type="text" class="form-control" placeholder="Descripcion" data-bind="value: descripcion.value, css: { 'is-invalid': descripcion.hasError() }" />
                    <!-- ko template: { name: "Validation", data: descripcion } -->
                    <!-- /ko  -->
                </div>
            </div>

            <div class="form-row mt-2">
                <div class="col-md-4">
                    <label>% Gastos</label>
                    <input type="text" class="form-control" placeholder="PorcentajeGastos" data-bind="value: porcentajeGastos.value, css: { 'is-invalid': porcentajeGastos.hasError() }" />
                    <!-- ko template: { name: "Validation", data: porcentajeGastos }-->
                    <!-- /ko -->
                </div>

                <div class="col-md-4">
                    <label>% Gancancias</label>
                    <input type="text" class="form-control" placeholder="PorcentajeGanancias" data-bind="value: porcentajeGanancia.value, css: { 'is-invalid': porcentajeGanancia.hasError() }" />
                    <!-- ko template: { name: "Validation", data: porcentajeGanancia }-->
                    <!-- /ko -->
                </div>

                <div class="col-md-4">
                    <label>% IVA</label>
                    <input type="text" class="form-control" placeholder="PorcentajeIVA" data-bind="value: porcentajeIva.value, css: { 'is-invalid': porcentajeIva.hasError() }" />
                    <!-- ko template: {name: "Validation", data: porcentajeIva }-->
                    <!-- /ko -->
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <ul class="list-group pt-4">
                <li class="list-group-item d-flex justify-content-between 1h-condensed">
                    <span>Subtotal</span>
                    <span class="text-muted" data-bind="template: { name: 'templatePrice', data: subtotal() }"> </span>
                </li>
                <li class="list-group-item d-flex justify-content-between 1h-condensed">
                    <span>IVA</span>
                    <span class="text-muted" data-bind="template: { name: 'templatePrice', data: iva() }"> </span>
                </li>
                <li class="list-group-item d-flex justify-content-between 1h-condensed">
                    <span>Total </span>
                    <strong data-bind="template: { name: 'templatePrice', data: total() }"> </strong>
                </li>
            </ul>
            <div class="text-right pt-2">
                <input type="submit" class="btn btn-primary" value="Guardar" />
                <button class="btn btn-secondary">
                    Borrar
                </button>
            </div>
        </div>

    </div>
</script>

<script id="Materiales" type="text/html">
    <div class="row">
        <div class="col-md-12">
            <h5>
                Materiales
            </h5>

            <div class="form-row">
                <div class="col-md-2">
                    <label>Cantidad</label>
                    <input type="text" placeholder="Cantidad" class="form-control" />
                </div>

                <div class="col-md-6">
                    <label>Descripción</label>
                    <input type="text" placeholder="Descripción" class="form-control" />
                </div>

                <div class="col-md-2">
                    <label>Precio</label>
                    <input type="text" placeholder="Precio" class="form-control" />
                </div>

                <div class="col-md-2">
                    <label>Acciones</label>
                    <input type="button" class="btn btn-default" value="Agregar" />
                </div>
            </div>

            <div class="form-row pt-4">
                <div class="col-md-12">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">Cantidad</th>
                                <th scope="col">Descripción</th>
                                <th scope="col">Precio</th>
                                <th scope="col">Costo</th>
                                <th scope="col"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- ko foreach: items -->
                            <tr>
                                <td>
                                    <div>
                                        <input type="text" class="form-control" placeholder="Cantidad" data-bind="value: cantidad.value, css: { 'is-invalid': cantidad.hasError() }" />
                                        <!-- ko  template: { name: "Validation", data: cantidad } -->
                                        <!-- /ko -->
                                    </div>
                                </td>
                                <td>
                                    <input type="text" class="form-control" placeholder="Descripcion" data-bind="value: descripcion.value, css: { 'is-invalid': descripcion.hasError() }" />
                                    <!-- ko  template: { name: "Validation", data: descripcion } -->
                                    <!-- /ko -->
                                </td>
                                <td>
                                    <input type="text" class="form-control" placeholder="Precio" data-bind="value: precio.value, css: { 'is-invalid': precio.hasError() }" />
                                    <!-- ko  template: { name: "Validation", data: precio } -->
                                    <!-- /ko -->
                                </td>
                                <td>
                                    <span data-bind="template: { name: 'templatePrice', data: costo() }"></span>
                                </td>
                                <td class="text-center">
                                    <button class="btn btn-secondary">Borrar</button>
                                </td>
                            </tr>
                            <!-- /ko -->

                            <tr>
                                <td>
                                    <span> 1 </span>
                                </td>
                                <td>
                                    <span>Porcentaje de gastos</span>
                                </td>
                                <td class="text-center">
                                    <span data-bind="text: porcentajeGastos.value"></span>
                                </td>
                                <td>
                                    <span data-bind="template: { name: 'templatePrice', data: gasto() }"> </span>
                                </td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>
                                    <span> 1 </span>
                                </td>
                                <td>
                                    <span>Porcentaje de ganancias</span>
                                </td>
                                <td class="text-center">
                                    <span data-bind="text: porcentajeGanancia.value"></span>
                                </td>
                                <td>
                                    <span data-bind="template: { name: 'templatePrice', data: ganancia() }"> </span>
                                </td>
                                <td></td>
                            </tr>
                            <tr>
                                <td class="text-right" colspan="3"><strong>Subtotal:</strong></td>
                                <td class="text-left" colspan="2">
                                    <span data-bind="template: { name: 'templatePrice', data: subtotal() }"> </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</script>